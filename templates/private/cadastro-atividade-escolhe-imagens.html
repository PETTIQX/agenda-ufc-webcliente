<div class="container" ng-init="init()">    <!-- FIXME: Ainda não faz uploads. Precisa dos parametros de flow-init antes -->
  <h3>Adicione imagens à sua ativiade</h3>
  <form>
    <div class="row"
    flow-init="{ target: imageUploadAddress,
      query:{ 'idAtividade': atividade._id },
      headers:{ 'x-auth': token },
      permanentErrors: [404,401,400,204],
      testChunks:false}"
      flow-files-submitted="$flow.upload()"
      flow-file-success="$file.msg = $message" >
      <button type="button" class="btn blue input-field file-field">
        Enviar Imagens
        <i class="material-icons left">collections</i>
        <input type="file"  flow-btn>
      </button>
      <div class="row">
        <div class="col s3" ng-repeat="file in $flow.files">
          <div class="card" ng-class="cardSelecionado(this)" >
            <div class="card-image">
              <!-- FIXME: JORDY: O tamanho da imagem aqui é setado hardcoded.
              Eu quem fiz e o resultado é satisfatório, mas não gostei do método  -->
              <img height="300" flow-img="file" alt="" />
            </div>
            <div class="card-content">
              <p>
                <span class="truncate">{{file.name}}</span><br>
                Tamanho: <span>{{file.size/1024 | number: 0 }} KB</span><br>
                {{file.msg}}
              </p>
              <div class="progress">
                <div class="determinate" ng-style="{width: (file.progress() * 100) + '%'}"></div>
              </div>
            </div>
            <div class="card-action">
              <a class="waves-effect waves-light btn red" ng-click="file.cancel()">Remover</a>
            </div>
          </div>
        </div>
      </div>
      <div class="input-field col s12">
        <button class="waves-effect waves-light btn blue" ui-sref="cadastro-atividade-agendamento({atividade: atividade})">Próximo</button>
      </div>
    </div>
  </form>
</div>
